#!/bin/bash
# Host-specific colour (31-36)
#
# If /etc/hostcolor and it is executable, it's used to obtain colour
# escape. If not â€” colour is generated from the host name (omitting
# red as it is reserved for critical servers).

ROOT_COLOUR_NO=${1:-31}

if [ -x /etc/hostcolour ]
then
    PS1_host_colour="$( /etc/hostcolour )"
fi

if [ -z "${PS1_host_colour}" ]
then
    MD5CMD="$( which md5sum || which md5 )"
    if [ -n "${MD5CMD}" ]
    then
        HOSTNAME_HASH=$( hostname | "${MD5CMD}" )
        if [ "$( tput colors )" -ge 256 ]
        then
            PS1_host_colour="$(
                tput setaf 0
                tput setab $(( 0x${HOSTNAME_HASH:32:2} + 2 ))
            )"
        else
            # values from 32-36 (all colours, but black, white and red)
            PS1_host_colour=$(( 0x${HOSTNAME_HASH:15:1} * 5 / 16 + 32 ))
            PS1_host_colour=$(( PS1_host_colour + 10 ))
            PS1_host_colour="\e[${PS1_host_colour}m"
        fi
    fi
fi

export PS1_host_colour

